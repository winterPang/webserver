{"version":3,"sources":["frame/component/form/oasis-select2.js"],"names":["defaults","sId","allowClear","placeholder","closeOnSelect","width","language","data","undefined","methods","selectEvents","_linkFunc","$scope","$ele","$attr","$","fn","select2","console","warn","jQuery","$watch","options","evtSuffix","each","i","e","on","args","Array","prototype","slice","call","arguments","$emit","apply","concat","m","$on","p","length","Function","opts","extend","isFunction","rs","isArray","then","directive","restrict","scope","link"],"mappings":";;;;;;;;;;;;;AAAA;;;AAUA,QAAIA,WAAW;AACXC,aAAK,EADM;AAEXC,oBAAY,IAFD;AAGXC,qBAAa,KAHF;AAIXC,uBAAe,IAJJ;AAKXC,eAAO,GALI;AAMXC,kBAAU,OANC;AAOXC,cAAMC,SAPK,CAOK;AAPL,KAAf;;AAUA,QAAIC,UAAU,CAAC,gBAAD,EAAmB,MAAnB,EAA2B,OAA3B,EACV,QADU,EACA,UADA,EACY,OADZ,EACqB,QADrB,EAC+B,MAD/B,EACuC,KADvC,EAEV,SAFU,EAEC,QAFD,CAAd;;AAKA,QAAIC,eAAe,CAAC,QAAD,EAAW,eAAX,EAA4B,iBAA5B,EAA+C,cAA/C,EACf,iBADe,EACI,gBADJ,EACsB,mBADtB,EAC2C,kBAD3C,EAEf,qBAFe,CAAnB;;AAKA,QAAIC,YAAY,SAAZA,SAAY,CAACC,MAAD,EAASC,IAAT,EAAcC,KAAd,EAAwB;AACpC,YAAI,CAACC,CAAD,IAAM,CAACA,EAAEC,EAAT,IAAe,CAACD,EAAEC,EAAF,CAAKC,OAAzB,EAAkC;AAC9BC,oBAAQC,IAAR,CAAa,kBAAb;AACA,mBAAO,KAAP;AACH;AACD,YAAI,EAAEN,gBAAgBO,MAAlB,CAAJ,EAA+B;AAC3BP,mBAAOE,EAAEF,IAAF,CAAP;AACH;AACD;AACAD,eAAOS,MAAP,CAAc,SAAd,EAAyB,UAASC,OAAT,EAAkB;AACvC,gBAAIA,OAAJ,EAAa;AACT;AACA,oBAAIC,YAAYD,QAAQrB,GAAR,GAAc,MAAMqB,QAAQrB,GAA5B,GAAkC,EAAlD;AACA;AACAc,kBAAES,IAAF,CAAOd,YAAP,EAAqB,UAASe,CAAT,EAAYC,CAAZ,EAAe;AAChCb,yBAAKc,EAAL,CAAQD,CAAR,EAAW,YAAW;AAClB,4BAAIE,OAAOC,MAAMC,SAAN,CAAgBC,KAAhB,CAAsBC,IAAtB,CAA2BC,SAA3B,EAAsC,CAAtC,CAAX;AACArB,+BAAOsB,KAAP,CAAaC,KAAb,CAAmBvB,MAAnB,EAA2B,CAACc,IAAIH,SAAL,EAAgBa,MAAhB,CAAuBR,IAAvB,CAA3B;AACH,qBAHD;AAIH,iBALD;AAMA;AACAb,kBAAES,IAAF,CAAOf,OAAP,EAAgB,UAASgB,CAAT,EAAYY,CAAZ,EAAe;AAC3BzB,2BAAO0B,GAAP,CAAWD,IAAId,SAAf,EAA0B,UAASG,CAAT,EAAYa,CAAZ,EAAeP,IAAf,EAAqB;AAC3C,4BAAIC,UAAUO,MAAV,IAAoB,CAApB,IAAyBD,aAAaE,QAA1C,EAAoD;AAChDF,8BAAEP,IAAF,CAAOnB,IAAP,EAAaA,KAAKI,OAAL,CAAaoB,CAAb,CAAb;AACH,yBAFD,MAEO,IAAIJ,UAAUO,MAAV,IAAoB,CAAxB,EAA2B;AAC9BR,iCAAKA,IAAL,CAAUnB,IAAV,EAAgBA,KAAKI,OAAL,CAAaoB,CAAb,EAAgBE,CAAhB,CAAhB;AACH,yBAFM,MAEA;AACH1B,iCAAKI,OAAL,CAAaoB,CAAb,EAAgBE,CAAhB;AACH;AACJ,qBARD;AASH,iBAVD;;AAYA,oBAAIG,OAAO3B,EAAE4B,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmB3C,QAAnB,EAA6BsB,OAA7B,CAAX;AACA,oBAAIf,OAAOmC,KAAKnC,IAAhB;AACA,oBAAIA,QAAQQ,EAAE6B,UAAF,CAAarC,IAAb,CAAZ,EAAgC;AAC5B;AACA,wBAAIsC,KAAKtC,MAAT;AACA;AACA,wBAAIQ,EAAE+B,OAAF,CAAUD,EAAV,CAAJ,EAAmB;AACfH,6BAAKnC,IAAL,GAAYsC,EAAZ;AACAhC,6BAAKI,OAAL,CAAayB,IAAb;AACH,qBAHD,MAGO,IAAIG,MAAMA,GAAGE,IAAb,EAAmB;AAAE;AACxBF,2BAAGE,IAAH,CAAQ,UAASxC,IAAT,EAAe;AACnBmC,iCAAKnC,IAAL,GAAYA,IAAZ;AACAM,iCAAKI,OAAL,CAAayB,IAAb;AACH,yBAHD,EAGG,YAAW;AACVA,iCAAKnC,IAAL,GAAY,EAAZ;AACAM,iCAAKI,OAAL,CAAayB,IAAb;AACH,yBAND;AAOH;AACJ,iBAhBD,MAgBO,IAAI3B,EAAE+B,OAAF,CAAUvC,IAAV,CAAJ,EAAqB;AACxBM,yBAAKI,OAAL,CAAayB,IAAb;AACH,iBAFM,MAEA;AACHA,yBAAKnC,IAAL,GAAYC,SAAZ;AACAK,yBAAKI,OAAL,CAAayB,IAAb;AACH;AACJ,aA/CD,MA+CO;AACH7B,qBAAKI,OAAL,CAAajB,QAAb;AACH;AACJ,SAnDD;AAoDH,KA7DD;;AA+DA,yBAAIgD,SAAJ,CAAc,SAAd,EAAyB,CAAC,YAAW;AACjC,eAAO;AACHC,sBAAU,IADP;AAEHC,mBAAO;AACH5B,yBAAS;AADN,aAFJ;AAKH6B,kBAAM,cAASvC,MAAT,EAAiBC,IAAjB,EAAuB;AACzBF,0BAAUC,MAAV,EAAkBC,IAAlB;AACH;AAPE,SAAP;AASH,KAVwB,CAAzB","file":"frame/component/form/oasis-select2.js","sourcesContent":["/**\n * 下拉框组件\n */\nimport app from 'angularAMD';\nimport Utils from 'utils';\nimport 'select2';\nimport 'select2-cn';\nimport 'select2-en';\nimport 'css!select2-bootstrap-theme';\n\nlet defaults = {\n    sId: '',\n    allowClear: true,\n    placeholder: '请选择',\n    closeOnSelect: true,\n    width: 150,\n    language: 'zh-CN',\n    data: undefined //  可以是数组，可以是方法，可以是promise\n};\n\nlet methods = ['toggleDropdown', 'open', 'close',\n    'isOpen', 'hasFocus', 'focus', 'enable', 'data', 'val',\n    'destroy', 'render'\n];\n\nlet selectEvents = ['change', 'select2:close', 'select2:closing', 'select2:open',\n    'select2:opening', 'select2:select', 'select2:selecting', 'select2:unselect',\n    'select2:unselecting'\n];\n\nlet _linkFunc = ($scope, $ele,$attr) => {\n    if (!$ || !$.fn || !$.fn.select2) {\n        console.warn('select2组件还没有初始化!');\n        return false;\n    }\n    if (!($ele instanceof jQuery)) {\n        $ele = $($ele);\n    }\n    // $.fn.select2.defaults.set(\"theme\", \"bootstrap\");\n    $scope.$watch('options', function(options) {\n        if (options) {\n            // 事件方法前缀\n            var evtSuffix = options.sId ? '#' + options.sId : '';\n            // 事件监听\n            $.each(selectEvents, function(i, e) {\n                $ele.on(e, function() {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    $scope.$emit.apply($scope, [e + evtSuffix].concat(args));\n                });\n            });\n            // 方法执行\n            $.each(methods, function(i, m) {\n                $scope.$on(m + evtSuffix, function(e, p, call) {\n                    if (arguments.length == 2 && p instanceof Function) {\n                        p.call($ele, $ele.select2(m));\n                    } else if (arguments.length == 3) {\n                        call.call($ele, $ele.select2(m, p));\n                    } else {\n                        $ele.select2(m, p);\n                    }\n                });\n            });\n\n            var opts = $.extend(true, {}, defaults, options);\n            var data = opts.data;\n            if (data && $.isFunction(data)) { \n                //  返回的是数组或者Promise对象可以处理，其他的不处理\n                var rs = data();\n                // 如果返回的Array\n                if ($.isArray(rs)) {\n                    opts.data = rs;\n                    $ele.select2(opts);\n                } else if (rs && rs.then) { //   返回的是Promise对象\n                    rs.then(function(data) {\n                        opts.data = data;\n                        $ele.select2(opts);\n                    }, function() {\n                        opts.data = [];\n                        $ele.select2(opts);\n                    });\n                }\n            } else if ($.isArray(data)) {\n                $ele.select2(opts);\n            } else {\n                opts.data = undefined;\n                $ele.select2(opts);\n            }\n        } else {\n            $ele.select2(defaults);\n        }\n    });\n}\n\napp.directive('select2', [function() {\n    return {\n        restrict: 'EA',\n        scope: {\n            options: '=select2'\n        },\n        link: function($scope, $ele) {\n            _linkFunc($scope, $ele);\n        }\n    }\n}]);\n"],"sourceRoot":"/source/"}