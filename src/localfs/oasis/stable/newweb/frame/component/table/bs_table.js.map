{"version":3,"sources":["frame/component/table/bs_table.js"],"names":["$","fn","bootstrapTable","console","warn","constant","extend","defaults","tId","showCheckBox","showRowNumber","showPageList","pagination","paginationLoop","showToolbar","paginationPreText","paginationNextText","paginationFirstText","paginationLastText","paginationSize","clickToSelect","undefinedText","searchable","striped","cache","pageList","apiVersion","operateWidth","operate","lang","getLang","extraCls","icons","reboot","download","detail","remove","edit","add","search","upgrade","imports","custom","detailOpen","detailClose","pageListChange","pageNumber","directive","def","$alert","_picker","option","locale","autoUpdateInput","eventHandle","ev","picker","$this","v","startDate","format","separator","endDate","_old","val","singleDatePicker","old","now","editor","_searcherDef","date","event","daterange","numberange","render","tpl","row","vars","match","length","map","replace","trim","each","rv","reg","RegExp","createTable","$ele","options","_searcher","on","e","opts","sidePagination","clearTimeout","_searchTimeOut","setTimeout","$searcher","bsOptions","searchText","allData","data","grepData","grep","d","exist","k","f","String","toUpperCase","indexOf","type","params","find","attr","trigger","newData","undefined","is","_val","isNaN","Number","start","end","pageParamsType","startField","limitField","test","columns","cm","filterSpace","input","formatter","link","text","linkNewPage","_formatter","width","align","field","index","pageSize","concat","singleSelect","checkbox","class","toolbar","push","join","off","bsOpts","currData","before","operaColumn","Date","title","operateTitle","operaHtml","isFunction","noop","tips","enable","click","delegate","actionName","parents","call","detailView","$detail","el","initSearcher","table","$container","$tableContainer","$thead","tr","i","cln","visible","searcher","types","valueField","textField","isArray","then","$select","appendTo","select2","allowClear","placeholder","minimumResultsForSearch","_selector","_this","_role","_field","_option","_def","apply","arguments","undelegate","extraFn","showSearcher","hideSearcher","$target","target","getTable","$search","next","c","$th","eq","hide","show","autoLoad","prev","Infinity","tableObj","css","window","dataField","totalField","totalRows","dataArray","split","ss","ss2","refresh","listenEvent","scope","events","self","toString","args","Array","prototype","slice","$emit","bindEvent","$on","p","Function","restrict","template","$scope","jQuery","$watch"],"mappings":"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","file":"frame/component/table/bs_table.js","sourcesContent":["import app from \"angularAMD\";\r\nimport bsTableLang from './frame/component/table/lang/bs_table';\r\nimport utils from 'utils';\r\n//import '$alert';\r\nimport 'bootstrapTable';\r\nimport 'select2';\r\nimport 'bootstrap-daterangepicker';\r\nimport 'bootstrapDatepicker';\r\nimport 'rangepicker';\r\nimport 'css!bootstrap_daterangepicker_css';\r\nimport 'css!bootstrap_table_css';\r\nimport 'css!./frame/component/table/less/index';\r\n\r\n\r\nif (!$ || !$.fn || !$.fn.bootstrapTable) {\r\n    console.warn('bootstrapTable组件还没有初始化!');\r\n    //return false;\r\n}\r\n// 表格默认值\r\napp.constant('bsTableDef', $.extend(true, {}, $.fn.bootstrapTable.defaults, {\r\n    tId: null, //  唯一标示table，页面有多个表格可以使用事件和方法的隔离\r\n    showCheckBox: false, //  显示表头的复选框\r\n    showRowNumber: false, //  显示行号\r\n    showPageList: true, //  显示分页大小切换\r\n    pagination: true, //  显示分页\r\n    paginationLoop: false, //  禁止分页循环\r\n    showToolbar: false, //  显示工具条\r\n    paginationPreText: '&lsaquo;', //    分页条上一页显示的文本\r\n    paginationNextText: '&rsaquo;', //   分页条下一页显示的文本\r\n    paginationFirstText: '&laquo;', //   第一页显示的文本  默认是两个小于号\r\n    paginationLastText: '&raquo;', //  最后一页显示的文本  默认是两个大于号\r\n    paginationSize: 'normal', //  分页条显示大小，normal正常样式，sm是只显示上一页下一页第一页最后一页\r\n    clickToSelect: true, //   点击行选中\r\n    undefinedText: '', //  数据是undefined显示''\r\n    searchable: false, //  是否支持搜索功能\r\n    striped: true, //  显示斑马线效果\r\n    cache: false, //  是否缓存数据\r\n    pageList: [10, 20, 50, 100],\r\n    apiVersion: 'v2', //  适配原来的v3接口，默认是v2，v3会有以下默认值，例如：分页参数路径化\r\n    operateWidth: 240, //  操作列宽度\r\n    operate: false, //  是否显示操作，是一个对象\r\n    lang: utils.getLang(), // 语言配置  目前只支持en和cn\r\n    extraCls: '', //  扩展类 ，直接加在最外层的容器上，为了适应单个需求和表格的个性化\r\n    // refreshUnCheck: true, //  刷新后清空选择\r\n    icons: { //  操作列对应的图标，见名知意\r\n        reboot: 'fa fa-refresh',\r\n        download: 'fa fa-download',\r\n        detail: 'fa fa-mydetail', //completed\r\n        remove: 'fa fa-del', //completed\r\n        edit: 'fa fa-myedit', //completed\r\n        add: 'fa fa-plus',\r\n        search: 'fa fa-search',\r\n        upgrade: 'fa fa-upload',\r\n        imports: 'fa fa-sign-in',\r\n        custom: 'fa fa-cab',\r\n        detailOpen: 'glyphicon-chevron-down', //  展开详情图标\r\n        detailClose: 'glyphicon-chevron-up' //  折叠详情图标\r\n    },\r\n    pageListChange: {\r\n        pageNumber: 'auto'\r\n    }\r\n})).directive('bsTable', ['bsTableDef', '$alertService', function(def, $alert) {\r\n    var _picker = {\r\n        option: {\r\n            locale: bsTableLang[utils.getLang()]['daterangepicker'],\r\n            autoUpdateInput: false\r\n        },\r\n        eventHandle: function(ev, picker) {\r\n            var $this = $(this),\r\n                v = picker.startDate.format(picker.locale.format) + picker.locale.separator + picker.endDate.format(picker.locale.format);\r\n            var _old = $this.val();\r\n            if (picker.singleDatePicker) {\r\n                v = picker.startDate.format('YYYY-MM-DD');\r\n            }\r\n            $this.val(v);\r\n            return { old: _old, now: v };\r\n        },\r\n        editor: 'daterangepicker'\r\n    };\r\n    var _searcherDef = {\r\n        date: $.extend(true, {\r\n            option: {\r\n                singleDatePicker: true,\r\n                format: 'yyyy-mm-dd'\r\n            },\r\n            event: 'hide.daterangepicker'\r\n        }, _picker),\r\n        daterange: $.extend(true, {\r\n            event: 'apply.daterangepicker'\r\n        }, _picker),\r\n        numberange: {\r\n            option: $.extend(true, {}, bsTableLang[utils.getLang()]['rangepicker']),\r\n            event: 'okclick.range',\r\n            editor: 'rangepicker'\r\n        }\r\n    };\r\n\r\n    def = $.extend(true, {}, def, bsTableLang[utils.getLang()]['table']);\r\n\r\n    /**\r\n     *\r\n     * @param tpl 模板   {field}  会替换为row[field]的值\r\n     * @param row\r\n     * @description 渲染文本，可以作为字符串的拼接。可以作为link和显示的格式化\r\n     * @example\r\n     *\r\n     * ```\r\n     *  var tpl = 'my name is {name}, I\\'m {age} years old.';\r\n     *  var row = {name:'zhangsan',age:26};\r\n     *  render(tpl,row) == 'my name is zhangsan, I\\'m 26 years old.'\r\n     * ```\r\n     */\r\n    function render(tpl, row) {\r\n        var vars = tpl.match(/{[a-zA-Z0-9]*}/g);\r\n        if (!vars || !vars.length) {\r\n            return tpl;\r\n        }\r\n        vars = $.map(vars, function(v) {\r\n            return v.replace(/{|}/g, '').trim();\r\n        });\r\n        $.each(vars, function() {\r\n            var v = this;\r\n            var rv = row[v] || '';\r\n            var reg = new RegExp('{' + v + '}', 'g');\r\n            tpl = tpl.replace(reg, rv);\r\n        });\r\n\r\n        return tpl;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param $ele  表格dom元素\r\n     * @param options   表格配置参数\r\n     * @description 创建表格\r\n     */\r\n    function createTable($ele, options) {\r\n\r\n        var _searcher = {};\r\n\r\n        $ele.on('searcher-change.bs.table', function(e) {\r\n            //  服务器搜索延迟1秒请求\r\n            if (opts.sidePagination == 'server') {\r\n                //  输入结束1s中请求一次后台\r\n                clearTimeout($ele._searchTimeOut);\r\n                $ele._searchTimeOut = setTimeout(function() {\r\n                    search();\r\n                }, 1000);\r\n            } else {\r\n                // 本地立即搜索\r\n                search();\r\n            }\r\n\r\n            // 修改查询条件后，查询第一页数据\r\n            function search() {\r\n                var $searcher = $ele.$searcher;\r\n                var bsOptions = $ele.bootstrapTable('getOptions');\r\n                var searchText = bsOptions.searchText;\r\n                var showToolbar = bsOptions.showToolbar;\r\n\r\n                if (showToolbar) {\r\n                    // 判断分页类型\r\n                    if (bsOptions.sidePagination == 'server') {\r\n                        //  服务器搜索\r\n                        $ele.bootstrapTable('getOptions').pageNumber = 1;\r\n                        $ele.bootstrapTable('refresh');\r\n                    } else {\r\n                        var allData = $ele.data('allData');\r\n                        var grepData = [];\r\n                        if (allData && allData.length) {\r\n                            grepData = $.grep(allData, function(d) {\r\n                                var exist = false;\r\n                                $.each(d, function(k, f) {\r\n                                    if (String(f).toUpperCase().indexOf(searchText.toUpperCase()) != -1) {\r\n                                        exist = true;\r\n                                        return false;\r\n                                    }\r\n                                });\r\n                                return exist;\r\n                            });\r\n                        }\r\n                        $ele.bootstrapTable('load', { type: 'search', data: grepData });\r\n                    }\r\n                } else {\r\n                    var params = {};\r\n                    $searcher.find('input,select').each(function() {\r\n                        if ($(this).data('range')) {\r\n                            params[$(this).attr('search-field')] = $(this).data('range');\r\n                        } else if ($(this).val() || ($(this).val() + '') === '0') {\r\n                            params[$(this).attr('search-field')] = $(this).val();\r\n                        }\r\n                    });\r\n                    // 判断分页类型\r\n                    if (opts.sidePagination == 'server') {\r\n                        //  服务器搜索\r\n                        $ele.bootstrapTable('getOptions').pageNumber = 1;\r\n                        $ele.bootstrapTable('refresh');\r\n                        $ele.trigger('search-server.bs.table', params);\r\n                    } else {\r\n                        var data = $ele.data('allData');\r\n                        var newData = [];\r\n                        if (data && data.length) {\r\n                            newData = $.grep(data, function(d) {\r\n                                var exist = true;\r\n                                $.each(params, function(k, v) {\r\n                                    d[k] = d[k] == undefined ? '' : d[k];\r\n                                    // 如果是下拉框，全值匹配，文本框模糊匹配\r\n                                    if ($ele.$searcher.find('[search-field=' + k + ']').is('select')) {\r\n                                        if ((d[k] + '').toUpperCase() != (v + '').toUpperCase()) {\r\n                                            exist = false;\r\n                                        }\r\n                                    } else if ($ele.$searcher.find('[search-field=' + k + ']').is('[search-role=\"numberange\"]')) {\r\n                                        // 包含开始不包含结束\r\n                                        var _val = isNaN(d[k]) ? 0 : Number(d[k]);\r\n                                        if (v.start != null && v.end != null && (_val < v.start || _val >= v.end)) {\r\n                                            exist = false;\r\n                                        } else if (v.start != null && _val < v.start) {\r\n                                            exist = false;\r\n                                        } else if (v.end != null && _val >= v.end) {\r\n                                            exist = false;\r\n                                        }\r\n                                    } else {\r\n                                        if ((d[k] + '').toUpperCase().indexOf((v + '').toUpperCase()) == -1) {\r\n                                            exist = false;\r\n                                        }\r\n                                    }\r\n                                });\r\n                                return exist;\r\n                            });\r\n                        }\r\n                        $ele.bootstrapTable('load', { type: 'search', data: newData });\r\n                        $ele.trigger('search-local.bs.table', params);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        // v3默认值\r\n        if (options.apiVersion === 'v3' && !options.pageParamsType) {\r\n            options.pageParamsType = 'path';\r\n        }\r\n        if (options.apiVersion === 'v3' && !options.startField && !options.limitField) {\r\n            options.startField = 'skipnum';\r\n            options.limitField = 'limitnum';\r\n        }\r\n\r\n        if (options.showToolbar) {\r\n            options.searchable = false;\r\n        }\r\n        // concat a configurations\r\n        var opts = $.extend(true, {}, def, options);\r\n\r\n        if (opts.tId && /^[0-9]/.test(opts.tId)) {\r\n            console.warn('tId不建议使用数字。');\r\n        }\r\n\r\n        /**\r\n         * 遍历渲染列数据模板\r\n         * render  基本渲染\r\n         * link    链接渲染\r\n         * linkNewPage   新标签页面打开渲染链接，link存在生效\r\n         */\r\n        $.each(opts.columns, function() {\r\n            var cm = this;\r\n\r\n            function filterSpace(input) {\r\n                input = input == undefined ? '' : input + '';\r\n                return input.replace(/ /g, '&nbsp;')\r\n            }\r\n\r\n            if (cm.render && typeof cm.render == 'string') {\r\n                cm.formatter = function(val, row) {\r\n                    return render(cm.render, row);\r\n                }\r\n            }\r\n            if (cm.link == true) {\r\n                cm.clickToSelect = false;\r\n                cm.formatter = function(val, row) {\r\n                    var text = (cm.render && typeof cm.render == 'string') ? render(cm.render, row) : val;\r\n                    text = text || '';\r\n                    return '<a style=\"cursor: pointer;text-decoration: none\">' + filterSpace(text) + '</a>'\r\n                };\r\n            } else if (typeof cm.link == 'string') {\r\n                cm.clickToSelect = false;\r\n                this.formatter = function(val, row) {\r\n                    var text = (cm.render && typeof cm.render == 'string') ? render(cm.render, row) : val;\r\n                    text = text || '';\r\n                    return '<a ' + (cm.linkNewPage ? ' target=\"_blank\" ' : '') + ' href=\"' + render(cm.link, row) + '\" style=\"cursor: pointer;text-decoration: none\">' + filterSpace(text) + '</a>'\r\n                };\r\n            }\r\n\r\n            var _formatter = cm.formatter;\r\n            if (!_formatter) {\r\n                cm.formatter = filterSpace;\r\n            }\r\n        });\r\n        // 显示行号和checkbox\r\n        if (opts.showRowNumber) {\r\n            opts.columns = [{\r\n                width: 36,\r\n                align: 'center',\r\n                field: 'bs-rownumber',\r\n                formatter: function(val, row, index) {\r\n                    return '<span>' + ((opts.pageNumber - 1) * opts.pageSize + (index + 1)) + '</span>'\r\n                }\r\n            }].concat(opts.columns);\r\n        }\r\n\r\n        // 多选\r\n        if (opts.showCheckBox && !opts.singleSelect) {\r\n            opts.columns = [{\r\n                checkbox: true //,\r\n                    // field: 'bs-checkbox'\r\n            }].concat(opts.columns);\r\n        } else if (opts.singleSelect) {\r\n            // 单选不显示多选框\r\n            opts.columns = [{\r\n                checkbox: true,\r\n                // field: 'bs-checkbox',\r\n                class: opts.showCheckBox ? '' : 'hidden' //  是否显示多选框checkbox\r\n            }].concat(opts.columns);\r\n        }\r\n\r\n        if (opts.showToolbar) {\r\n            opts.showPageList = false;\r\n            var toolbar = [];\r\n            toolbar.push(\r\n                '<div style=\"height:34px;line-height:30px;margin-bottom: 10px\">',\r\n                '<div class=\"pull-left col-xs-6\">',\r\n                '每页 <select style=\"width: 80px;\" select2>'\r\n            );\r\n\r\n            $.each(opts.pageList, function() {\r\n                toolbar.push('<option value=\"', this, '\">', this, '</option>');\r\n            });\r\n\r\n            toolbar.push(\r\n                '</select> 条记录',\r\n                '</div>',\r\n                '<div class=\"pull-right col-xs-4\">',\r\n                '<div class=\"col-xs-4 text-right\">搜索：</div>',\r\n                '<div class=\"col-xs-8\"><input type=\"text\"></div>',\r\n                '</div>',\r\n                '</div>'\r\n            );\r\n            $ele.toolbar = $(toolbar.join(''));\r\n            $ele.toolbar.find('[select2]').val(opts.pageSize).off('change').on('change', function() {\r\n                var bsOpts = $ele.bootstrapTable('getOptions');\r\n                bsOpts.pageSize = $(this).val();\r\n\r\n                if (bsOpts.sidePagination == 'server') {\r\n                    $ele.bootstrapTable('refresh');\r\n                } else {\r\n                    var currData = $ele.bootstrapTable('getData');\r\n                    $ele.bootstrapTable('load', currData);\r\n                }\r\n            }) /*.select2({allowClear: false, minimumResultsForSearch: -1})*/ ;\r\n\r\n            //searcher-change.bs.table\r\n            $ele.toolbar.find('input').off('keyup').on('keyup', function() {\r\n                $ele.bootstrapTable('getOptions').searchText = $(this).val();\r\n                $ele.trigger('searcher-change.bs.table');\r\n            });\r\n            $ele.before($ele.toolbar);\r\n        }\r\n\r\n        // 显示操作列\r\n        if (opts.operate && typeof opts.operate === 'object') {\r\n\r\n            var operaColumn = {\r\n                clickToSelect: false,\r\n                field: +new Date(),\r\n                width: opts.operateWidth,\r\n                title: opts.operateTitle\r\n            };\r\n\r\n            operaColumn.formatter = function(val, row) {\r\n                var operaHtml = ['<div>'];\r\n                $.each(opts.operate, function(k, v) {\r\n                    if ($.isFunction(v) && v !== $.noop) {\r\n                        operaHtml.push('<button role=\"opera_', k, '\" class=\"table_opera list-link\" title=\"', opts.tips[k], '\" >',\r\n                            '<i class=\"', opts.icons[k], '\"></i>',\r\n                            '</button>');\r\n                    } else if (typeof v === 'object') {\r\n                        // 如果没有配置就是true\r\n                        var enable = v.enable || true;\r\n                        if ($.isFunction(enable)) {\r\n                            enable = enable(val, row);\r\n                        }\r\n                        if (v.click && v.click != $.noop) {\r\n                            operaHtml.push('<button role=\"opera_', k, '\" class=\"table_opera  list-link\" title=\"', opts.tips[k], '\" ', enable ? '' : 'disabled=\"disabled\"', '>',\r\n                                '<i class=\"', opts.icons[k], '\"></i>',\r\n                                '</button>');\r\n                        }\r\n                    }\r\n                });\r\n                operaHtml.push('</div>');\r\n                return operaHtml.join('');\r\n            };\r\n            opts.columns.push(operaColumn);\r\n            /**\r\n             * 操作列的配置，jquery事件代理模式\r\n             *\r\n             */\r\n            $ele.delegate('button[role^=opera_]', 'click', function(e) {\r\n                var actionName = $(this).attr('role').replace('opera_', '');\r\n                var index = $(this).parents('tr').attr('data-index');\r\n                // 获取数据\r\n                var data = $ele.bootstrapTable('getData')[Number(index)];\r\n                // 执行操作\r\n                if ($.isFunction(opts.operate[actionName])) {\r\n                    opts.operate[actionName].call(this, e, data, $(this));\r\n                } else if (opts.operate[actionName] && opts.operate[actionName].click && $.isFunction(opts.operate[actionName].click)) {\r\n                    opts.operate[actionName].click.call(this, e, data, $(this));\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n        // 如果detailView为true\r\n        if (opts.detailView) {\r\n            // 点击行展开详情\r\n            $ele.on('expand-row.bs.table', function(e, index, row, $detail) {\r\n                $ele.find('tbody>tr[data-index!=' + index + ']').each(function() {\r\n                    $ele.bootstrapTable('collapseRow', Number($(this).attr('data-index')));\r\n                });\r\n                $ele.find('tbody>tr[data-index=' + index + ']').data('expand', true);\r\n                $ele.trigger('expanded-row.bs.table', { index: index, row: row, el: $detail });\r\n            }).on('collapse-row.bs.table', function(e, index, row, $detail) {\r\n                $ele.find('tbody>tr[data-index=' + index + ']').data('expand', false);\r\n                $ele.trigger('collapsed-row.bs.table', { index: index, row: row, el: $detail });\r\n            });\r\n        }\r\n\r\n        // 显示搜索头部信息\r\n        if (opts.searchable) {\r\n            opts.columns.push({\r\n                width: 20,\r\n                align: 'center',\r\n                field: 'bs-search',\r\n                title: '<i class=\"glyphicon glyphicon-search\"></i>'\r\n            });\r\n\r\n            var extraFn = {\r\n                getTable: function() {\r\n                    return $ele.data('bootstrap.table');\r\n                },\r\n                showSearcher: function() {\r\n                    var $container = extraFn.getTable().$tableContainer;\r\n                    var $thead = $container.find('thead>tr');\r\n                    var $search = $thead.next();\r\n                    var columns = extraFn.getTable().columns;\r\n                    $.each(columns, function(i, c) {\r\n                        $thead.find('[search-field=\"' + c.field + '\"]').parents('th')[c.visible ? 'show' : 'hide']();\r\n                    });\r\n                    $thead.find('th').each(function(i) {\r\n                        var $th = $(this);\r\n                        if ($th.attr('style')) {\r\n                            $search.find('th').eq(i).attr('style', $th.attr('style'));\r\n                        } else {\r\n                            $search.find('th').eq(i).width($th.width() - 16);\r\n                        }\r\n                    });\r\n                    $thead.hide().next().show();\r\n                    // 触发查询事件\r\n                    $ele.trigger('searcher-show.bs.table')\r\n                },\r\n                /**\r\n                 * 隐藏搜索表头\r\n                 * @param autoLoad 是否重新加载数据\r\n                 */\r\n                hideSearcher: function(autoLoad) {\r\n                    var $container = extraFn.getTable().$tableContainer;\r\n                    var $searcher = $container.find('thead>tr').next();\r\n                    autoLoad = autoLoad != undefined ? autoLoad : true;\r\n                    if ($searcher.attr('style') != 'display: none;') { //  如果搜索表头在显示状态\r\n                        $searcher.hide().prev().show(); //  隐藏\r\n                        if (autoLoad) {\r\n                            // 触发查询事件\r\n                            $ele.trigger('searcher-hide.bs.table');\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            $ele.data('extraFn', extraFn);\r\n\r\n            function initSearcher(table) {\r\n                // 查询支持\r\n                var $container = table.$tableContainer;\r\n                var $thead = $container.find('thead'); //  获取第一个表头\r\n                if ($thead.find('tr.header-search').length) { //  已经渲染了搜索直接返回\r\n                    return;\r\n                }\r\n                opts = table.options;\r\n                var tr = ['<tr class=\"header-search\" style=\"display: none\">'];\r\n                $.each(opts.columns[0], function(i, cln) {\r\n                    if (!cln.visible) {\r\n                        return;\r\n                    }\r\n                    // tr.push('<th>');\r\n                    if (opts.singleSelect && !opts.showCheckBox && cln.checkbox) { //  如果是单选并且不显示checkbox渲染空列\r\n                        tr.push('<th class=\"hidden\">');\r\n                    } else {\r\n                        tr.push('<th>');\r\n                    }\r\n                    if (cln.field === 'bs-search') {\r\n                        tr.push('<i class=\"glyphicon glyphicon-remove searcher-hide\"></i>');\r\n                    } else if (cln.searcher) {\r\n                        var types = ['text', 'number'];\r\n                        _searcher[cln.field] = cln.searcher.option || null; //   缓存查询组件的配置\r\n                        cln.searcher.type = cln.searcher.type || 'text';\r\n                        if (types.indexOf(cln.searcher.type) != -1) {\r\n                            tr.push('<input search-field=\"', cln.field, '\" type=\"', cln.searcher.type, '\" placeholder=\"', cln.title, '\">');\r\n                        } else if (cln.searcher.type == 'select') {\r\n                            tr.push('<select style=\"width:100%\" search-field=\"', cln.field, '\" placeholder=\"', cln.title, '\">');\r\n                            // 数据处理\r\n                            cln.searcher.valueField = cln.searcher.valueField || 'value';\r\n                            cln.searcher.textField = cln.searcher.textField || 'text';\r\n                            tr.push('<option value=\"\">请选择</option>');\r\n                            if ($.isArray(cln.searcher.data)) {\r\n                                $.each(cln.searcher.data, function() {\r\n                                    tr.push('<option value=\"', this[cln.searcher.valueField], '\">', this[cln.searcher.textField], '</option>');\r\n                                });\r\n                            } else if ($.isFunction(cln.searcher.data)) {\r\n                                var data = cln.searcher.data();\r\n                                if ($.isArray(data)) {\r\n                                    $.each(data, function() {\r\n                                        tr.push('<option value=\"', this[cln.searcher.valueField], '\">', this[cln.searcher.textField], '</option>');\r\n                                    });\r\n                                } else if ($.isFunction(data.then)) {\r\n                                    data.then(function(d) {\r\n                                        var $select = $ele.$searcher.find('select[search-field=\"' + cln.field + '\"]');\r\n                                        $.each(d, function() {\r\n                                            $(['<option value=\"',\r\n                                                this[cln.searcher.valueField],\r\n                                                '\">',\r\n                                                this[cln.searcher.textField],\r\n                                                '</option>'\r\n                                            ].join('')).appendTo($select);\r\n                                        });\r\n                                    });\r\n                                }\r\n                            }\r\n                            tr.push('</select>');\r\n                        } else if (cln.searcher.type == 'daterange' || cln.searcher.type == 'date' || cln.searcher.type == 'numberange') { //  时间范围的处理\r\n                            tr.push('<input readonly search-role=\"', cln.searcher.type, '\" search-field=\"', cln.field, '\" type=\"text\" placeholder=\"', cln.title, '\">');\r\n                        }\r\n                    } else {\r\n                        tr.push('<div class=\"search-plain\">', cln.title, '</div>');\r\n                    }\r\n                    tr.push('</th>');\r\n                });\r\n                if (opts.detailView) {\r\n                    tr.push('<th></th>');\r\n                }\r\n                tr.push('</tr>');\r\n                $(tr.join('')).appendTo($thead);\r\n\r\n                $ele.$searcher = $container.find('.header-search');\r\n                $ele.$searcher.find('select').each(function() {\r\n                    $(this).select2({\r\n                        allowClear: true,\r\n                        placeholder: $(this).attr('placeholder'),\r\n                        minimumResultsForSearch: -1\r\n                    });\r\n                });\r\n                // 绑定编辑器\r\n                var _selector = [];\r\n                $.each(_searcherDef, function(k, v) {\r\n                    _selector.push('[search-role=\"' + k + '\"]');\r\n                });\r\n                // 查询匹配的编辑器\r\n                $ele.$searcher.find(_selector.join(',')).each(function() {\r\n                    var _this = $(this),\r\n                        _role = _this.attr('search-role'),\r\n                        _field = _this.attr('search-field'),\r\n                        _option = _searcher[_field] || {},\r\n                        _def = _searcherDef[_role];\r\n                    _this.off(_def.event).on(_def.event, function() {\r\n                        if (_def.eventHandle) {\r\n                            var _val = _def.eventHandle.apply(this, arguments);\r\n                            if (_val.now != _val.old) {\r\n                                $ele.trigger('searcher-change.bs.table', [_field, _val.now]);\r\n                            }\r\n                        } else {\r\n                            $ele.trigger('searcher-change.bs.table', [_field]);\r\n                        }\r\n                    })[_def.editor]($.extend(true, {}, _def.option || {}, _option));\r\n                });\r\n\r\n                /**\r\n                 * 表头搜索处理，自动查询\r\n                 */\r\n                $container.undelegate('[data-field=\"bs-search\"] i', 'click')\r\n                    .delegate('[data-field=\"bs-search\"] i', 'click', extraFn.showSearcher)\r\n                    .undelegate('i.searcher-hide', 'click')\r\n                    .delegate('i.searcher-hide', 'click', extraFn.hideSearcher)\r\n                    .undelegate('.header-search select', 'change')\r\n                    .delegate('.header-search select', 'change', function(e) {\r\n                        var $target = $(e.target);\r\n                        $ele.trigger('searcher-change.bs.table', [$target.attr('search-field'), $target.val()]);\r\n                    })\r\n                    .undelegate('.header-search input', 'keyup')\r\n                    .delegate('.header-search input', 'keyup', function(e) {\r\n                        var $target = $(e.target);\r\n                        $ele.trigger('searcher-change.bs.table', [$target.attr('search-field'), $target.val()]);\r\n                    });\r\n            }\r\n\r\n            $ele.on('post-body.bs.table', function(e, table) {\r\n                initSearcher(table);\r\n            }).on('searcher-hide.bs.table', function(e) {\r\n                $ele.$searcher.find('input').val('');\r\n                $ele.$searcher.find('select').select2('val', Infinity); //  清空数据\r\n                $ele.trigger('searcher-change.bs.table');\r\n            });\r\n        }\r\n\r\n        $ele\r\n            .on('loading.bs.table', function(e, tableObj) { //  不显示无数据\r\n                tableObj.$tableContainer.find('.no-records-found').find('div').css('visibility', 'hidden');\r\n            })\r\n            .on('loaded.bs.table', function(e, tableObj) { //  显示无数据\r\n                tableObj.$tableContainer.find('.no-records-found').find('div').css('visibility', tableObj.data.length ? 'hidden' : 'visible');\r\n            })\r\n            .on('page-change.bs.table', function() {\r\n                $(window).trigger('resize');\r\n            })\r\n            .on('load-success.bs.table', function(e, data) {\r\n                //如果当前页没有数据，直接查询上一页\r\n                var table = $ele.data('bootstrap.table');\r\n                var options = table.options;\r\n                var dataField = options.dataField;\r\n                var totalField = options.totalField;\r\n                var totalRows = data[totalField],\r\n                    dataArray = data[dataField];\r\n\r\n                if (totalField.split('.').length == 2) {\r\n                    var ss = totalField.split('.');\r\n                    if (data[ss[0]] && data[ss[0]][ss[1]]) {\r\n                        totalRows = data[ss[0]][ss[1]];\r\n                    } else {\r\n                        totalRows = 0;\r\n                    }\r\n                }\r\n                if (dataField.split('.').length == 2) {\r\n                    var ss2 = dataField.split('.');\r\n                    if (data[ss2[0]] && data[ss2[0]][ss2[1]]) {\r\n                        dataArray = data[ss2[0]][ss2[1]];\r\n                    } else {\r\n                        dataArray = [];\r\n                    }\r\n                }\r\n\r\n                dataArray && !dataArray.length && totalRows && options.pageNumber > 0 && table.refresh({ pageNumber: options.pageNumber });\r\n                $(window).trigger('resize');\r\n                // if (options.refreshUnCheck) {\r\n                //     // 如果有选择的数据 ，刷新后取消所有的选择\r\n                //     // $ele.bootstrapTable('uncheckAll');  //  取消选择\r\n                //     // var arr = $ele.bootstrapTable('getSelections');\r\n                //     // $.each(arr, function (i, a) {\r\n                //     //     $ele.bootstrapTable('uncheck');\r\n                //     // });\r\n                // }\r\n            })\r\n            .on('column-switch.bs.table', function(e, field, show) {\r\n                initSearcher($ele.data('bootstrap.table'));\r\n            });\r\n\r\n        // 如果表格存在，直接刷新options\r\n        return !!$ele.data('bootstrap.table') ? $ele.bootstrapTable('refreshOptions', opts) : $ele.bootstrapTable(opts);\r\n    }\r\n\r\n    /**\r\n     * @param $ele\r\n     * @param scope\r\n     * @param tId\r\n     * @description  表格的事件监听\r\n     * @example\r\n     * ```\r\n     *      $scope.$on('click-row.bs.table',function(){\r\n     *          // code\r\n     *      });\r\n     * ```\r\n     */\r\n    function listenEvent($ele, scope, tId) {\r\n        var events = ['all.bs.table', 'click-row.bs.table',\r\n            'dbl-click-row.bs.table', 'click-cell.bs.table',\r\n            'dbl-click-cell.bs.table', 'sort.bs.table',\r\n            'check.bs.table', 'uncheck.bs.table',\r\n            'check-all.bs.table', 'uncheck-all.bs.table',\r\n            'check-some.bs.table', 'uncheck-some.bs.table',\r\n            'load-success.bs.table', 'load-error.bs.table',\r\n            'column-switch.bs.table', 'column-search.bs.table',\r\n            'page-change.bs.table', 'search.bs.table',\r\n            'toggle.bs.table', 'pre-body.bs.table',\r\n            'post-body.bs.table', 'post-header.bs.table',\r\n            'expand-row.bs.table', 'collapse-row.bs.table',\r\n            'expanded-row.bs.table', 'collapsed-row.bs.table',\r\n            'searcher-change.bs.table', 'searcher-hide.bs.table',\r\n            'searcher-show.bs.table', 'refresh-options.bs.table',\r\n            'refresh.bs.table', 'search-local.bs.table',\r\n            'search-server.bs.table'\r\n        ];\r\n\r\n        $.each(events, function() {\r\n            var self = this.toString();\r\n            var e = tId ? self + '#' + tId : self;\r\n            $ele.off(self).on(self, function() {\r\n                var args = Array.prototype.slice.call(arguments, 1);\r\n                scope.$emit.apply(scope, [e.toString()].concat(args).concat(arguments[0]));\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param $ele\r\n     * @param scope\r\n     * @param tId\r\n     * @description 方法处理\r\n     * @example\r\n     * ```\r\n     *      $scope.$broadcast('load',[data]);\r\n     *      $scope.$broadcast('getSelections',function(data){\r\n     *          //  code\r\n     *      });\r\n     * ```\r\n     */\r\n    function bindEvent($ele, scope, tId) {\r\n        var events = ['getOptions', 'getSelections',\r\n            'getAllSelections', 'getData', 'getRowByUniqueId',\r\n            'getRowsHidden', 'getHiddenColumns', 'getVisibleColumns',\r\n            'getScrollPosition', 'collapseAllRows', 'expandAllRows',\r\n            'collapseRow', 'expandRow', 'toggleView',\r\n            'togglePagination', 'nextPage', 'prevPage',\r\n            'selectPage', 'filterBy', 'scrollTo',\r\n            'hideColumn', 'showColumn', 'resetWidth',\r\n            'resetView', 'uncheckBy', 'checkBy',\r\n            'uncheck', 'check', 'uncheckAll', 'load',\r\n            'checkAll', 'hideLoading', 'showLoading',\r\n            'resetSearch', 'refresh', 'updateCell',\r\n            'mergeCells', 'hideRow', 'showRow',\r\n            'updateRow', 'insertRow', 'removeByUniqueId',\r\n            'removeAll', 'remove', 'prepend', 'refreshOptions',\r\n            'append', 'hideAllColumns', 'showAllColumns'\r\n        ];\r\n\r\n        $.each(events, function() {\r\n            var self = this.toString();\r\n            var e = tId ? self + '#' + tId : self;\r\n            scope.$on(e.toString(), function(e, p, call) {\r\n                if (arguments.length == 2 && p instanceof Function) {\r\n                    p.call($ele, $ele.bootstrapTable(self));\r\n                } else if (arguments.length == 3) {\r\n                    call.call($ele, $ele.bootstrapTable(self, p));\r\n                } else {\r\n                    $ele.bootstrapTable(self, p);\r\n                }\r\n            });\r\n        });\r\n        // 自定义方法，显示或隐藏搜索框\r\n        scope.$on(tId ? 'showSearcher#' + tId : 'showSearcher', function(e) {\r\n            $ele.data('extraFn').showSearcher();\r\n        });\r\n        scope.$on(tId ? 'hideSearcher#' + tId : 'hideSearcher', function(e, autoLoad) {\r\n            $ele.data('extraFn').hideSearcher(autoLoad);\r\n        });\r\n    }\r\n\r\n    return {\r\n        restrict: 'EA',\r\n        scope: {\r\n            options: '=bsTable'\r\n        },\r\n        template: '<table class=\"oasis-table\"></table>',\r\n        replace: true,\r\n        link: function($scope, $ele) {\r\n            if (!($ele instanceof jQuery)) {\r\n                $ele = $($ele);\r\n            }\r\n            $scope.$watch('options', function(options) {\r\n                if (options) {\r\n                    listenEvent($ele, $scope, options.tId);\r\n                    createTable($ele, options);\r\n                    bindEvent($ele, $scope, options.tId);\r\n                }\r\n            });\r\n        }\r\n    };\r\n}]);\r\n"],"sourceRoot":"/source/"}